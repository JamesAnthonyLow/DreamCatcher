<h1><%= @dream.title %></h1>

<div id="dream-show" data-form="edit">
 <%= render "edit" %>
</div>

posted on <%= display_date(@dream.created_at) %><br>

<%= gravatar_tag @dream.dreamer.email, default: "http://img1.wikia.nocookie.net/__cb20111127192946/frontierville/images/f/f0/Shaman_Dream_Catcher-icon.png", :html => {:class => "avatar-icon"} %>
<%= link_to @dream.dreamer.username, profile_path(@dream.dreamer) %><br>
<% if @dream.dreamer == current_dreamer %>
  <%= link_to image_tag("edit-icon.png", class: "icon"), edit_dream_path(@dream), data: { link: "edit-dream" } %>
  <%= link_to image_tag("delete-icon.png", class: "icon"), dream_path(@dream), method: "delete" %>
<% end %>

<hr>
<p>
  <%= @dream.story %>
</p>
<p>
  Tags:
  <% @dream.hashtags.each do |hashtag| %>
    <%= search_form_for @q, url: hashtag_search_path, method: "get" do |f| %>
      <%= f.search_field :name_eq, value: hashtag.name %>
    <% end %>
    <%= link_to "Delete", hashtag_path(dream_id: @dream, id: hashtag), method: "delete" %>
  <% end %>
</p>

<h3><%= @dream.comments.count %> Comments</h3>

<% if @dream.comments.empty? %>
  <p>This dream currently has no comments.<br>
    Be the first to leave a comment.</p>
<% end %>

<ul>
  <div class="comment">
    <% @dream.comments.each do |comment| %>
        <li>
          <div class="left">
            <%= gravatar_tag comment.dreamer.email, class: "icon", default: "http://img1.wikia.nocookie.net/__cb20111127192946/frontierville/images/f/f0/Shaman_Dream_Catcher-icon.png", :html => {:class => "avatar-icon"} %> <%= link_to comment.dreamer.username, profile_path(comment.dreamer) %>
          </div>
          <div class="right">
            <p><%= display_date(comment.created_at) %></p>
            <p><%= link_to "Edit", edit_comment_path(comment) %></p>
          </div>
          <p><%= comment.content %></p>
        </li>
    <% end %>
  </div>
</ul>
<hr>
<%= render "comments/new" %>
